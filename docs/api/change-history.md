# История изменений (`change_history`)

Таблица `change_history` служит для автоматического логирования всех значимых изменений в системе. Каждая запись фиксирует, кто, когда и какие изменения внёс в конкретную сущность базы данных.


## Структура таблицы

| Поле          | Тип             | Описание                                      |
|---------------|-----------------|-----------------------------------------------|
| `id`          | `serial`        | Первичный ключ                                |
| `date`        | `timestamp`     | Дата и время изменения (по умолчанию текущее) |
| `object_type` | `varchar(255)`  | Тип объекта                                   |
| `object_id`   | `integer`       | Идентификатор объекта                         |
| `changes`     | `json`          | Подробное описание изменений в формате JSON   |
| `user_id`     | `integer`       | ID пользователя, совершившего изменение       |
| `created_at`  | `timestamp`     | Дата создания записи                          |
| `updated_at`  | `timestamp`     | Дата последнего обновления записи             |

## Пример содержимого поля `changes`

```json
{
    "id": 1,
    "date": "2025-05-14T22:37:52.098Z",
    "object_type": "employee",
    "object_id": 1,
    "changes": {
        "old": {
            "last_name": "Doe",
            "updated_at": "2025-05-14T22:37:32.614Z"
        },
        "new": {
            "last_name": "Doe1",
            "updated_at": "2025-05-14T22:37:52.098Z"
        }
    },
    "user_id": 1,
    "created_at": "2025-05-14T22:37:52.098Z",
    "updated_at": "2025-05-14T22:37:52.098Z",
    "user": {
        "first_name": "Admin",
        "last_name": "User",
        "patronymic": "Adminovich"
    }
}
```